
<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ø¯ÛŒØ±ÛŒØª Ø¨Ø§Ø²ÛŒ Ù¾Ø§Ø³ÙˆØ± - Ø¢Ù…Ø§Ø± Ú©Ù„ÛŒ</title>
    <style>
        * {
            box-sizing: border-box;
            font-family: 'Vazir', 'Tahoma', sans-serif;
        }
        body {
            background: #f0f2f5;
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
        }
        .container {
            max-width: 1200px;
            width: 100%;
            background: white;
            border-radius: 24px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            padding: 24px;
        }
        h1, h2, h3 {
            margin-top: 0;
            color: #1e293b;
        }
        .header-actions {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 24px;
            background: #f8fafc;
            padding: 16px;
            border-radius: 16px;
        }
        .input-group {
            display: flex;
            gap: 8px;
            flex: 1 1 300px;
        }
        .input-group input {
            flex: 1;
            padding: 10px 16px;
            border: 1px solid #cbd5e1;
            border-radius: 40px;
            font-size: 1rem;
            outline: none;
            transition: 0.2s;
        }
        .input-group input:focus {
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59,130,246,0.1);
        }
        button {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 40px;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: 0.2s;
            border: 1px solid transparent;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }
        button:hover {
            background: #2563eb;
        }
        button.secondary {
            background: #94a3b8;
        }
        button.secondary:hover {
            background: #64748b;
        }
        button.danger {
            background: #ef4444;
        }
        button.danger:hover {
            background: #dc2626;
        }
        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        button.small {
            padding: 4px 10px;
            font-size: 0.85rem;
        }
        .current-game {
            background: linear-gradient(145deg, #1e293b, #0f172a);
            color: white;
            border-radius: 32px;
            padding: 24px;
            margin-bottom: 30px;
            box-shadow: 0 20px 25px -5px rgba(0,0,0,0.2);
        }
        .current-game h2 {
            color: #f1f5f9;
            margin-bottom: 20px;
            text-align: center;
        }
        .matchup {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: center;
        }
        .team-card {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(4px);
            border-radius: 28px;
            padding: 24px;
            flex: 1 1 280px;
            text-align: center;
            border: 1px solid rgba(255,255,255,0.2);
        }
        .team-card h3 {
            color: #fbbf24;
            font-size: 2rem;
            margin: 0 0 8px;
            word-break: break-word;
        }
        .stats {
            display: flex;
            justify-content: center;
            gap: 24px;
            margin: 16px 0;
            font-size: 1.3rem;
        }
        .stats span {
            background: #0f172a;
            padding: 8px 16px;
            border-radius: 40px;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        .actions {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            margin-top: 16px;
        }


.actions button {
            flex: 1 0 120px;
            justify-content: center;
            background: #fbbf24;
            color: #0f172a;
            font-weight: bold;
        }
        .actions button.kot-hakemi {
            background: #ef4444;
            color: white;
        }
        .teams-list {
            background: #f1f5f9;
            border-radius: 24px;
            padding: 20px;
            margin-top: 20px;
        }
        .teams-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            margin-bottom: 16px;
        }
        .team-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: white;
            padding: 12px 20px;
            border-radius: 40px;
            margin-bottom: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            flex-wrap: wrap;
            gap: 10px;
        }
        .team-info {
            display: flex;
            align-items: center;
            gap: 20px;
            flex-wrap: wrap;
        }
        .team-name {
            font-weight: 700;
            font-size: 1.2rem;
            min-width: 120px;
        }
        .stat-control {
            display: flex;
            align-items: center;
            gap: 6px;
            background: #f1f5f9;
            padding: 4px 8px;
            border-radius: 40px;
        }
        .stat-control span {
            min-width: 30px;
            text-align: center;
            font-weight: 600;
        }
        .remove-btn {
            background: #fee2e2;
            color: #b91c1c;
            border: none;
            padding: 6px 16px;
            border-radius: 40px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: 0.2s;
        }
        .remove-btn:hover:not(:disabled) {
            background: #fecaca;
        }
        .remove-btn:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }
        .empty-state {
            text-align: center;
            padding: 40px;
            color: #64748b;
        }
        .overall-stats {
            background: #dbeafe;
            border-radius: 16px;
            padding: 16px;
            margin-top: 20px;
            display: flex;
            flex-wrap: wrap;
            gap: 16px;
            align-items: center;
            justify-content: space-between;
        }
        .overall-stats h3 {
            margin: 0;
            color: #1e3a8a;
        }
        .overall-stats .stats-summary {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
        }
        footer {
            margin-top: 24px;
            text-align: center;
            color: #94a3b8;
        }
    </style>
</head>
<body>
<div class="container" id="app">
    <h1>ğŸ“Š Ù…Ø¯ÛŒØ±ÛŒØª Ø¨Ø§Ø²ÛŒ Ù¾Ø§Ø³ÙˆØ±</h1>

    <!-- Ù†ÙˆØ§Ø± Ø§Ø¨Ø²Ø§Ø± -->
    <div class="header-actions">
        <div class="input-group">
            <input type="text" id="teamNameInput" placeholder="Ù†Ø§Ù… ØªÛŒÙ… Ø¬Ø¯ÛŒØ¯..." maxlength="20">
            <button id="addTeamBtn">â• Ø§ÙØ²ÙˆØ¯Ù† ØªÛŒÙ…</button>
        </div>
        <button id="drawBtn" class="secondary">ğŸ² Ù‚Ø±Ø¹Ù‡â€ŒÚ©Ø´ÛŒ Ùˆ Ø´Ø±ÙˆØ¹</button>
        <button id="endMatchBtn" class="secondary">ğŸ Ù¾Ø§ÛŒØ§Ù† Ù…Ø³Ø§Ø¨Ù‚Ù‡ (Ø¨Ù‡ ØªÛŒÙ… Ø§ÙˆÙ„ +Û± Ø¨Ø±Ø¯)</button>
        <button id="resetStatsBtn" class="secondary">ğŸ”„ Ø±ÛŒØ³Øª Ù‡Ù…Ù‡ (Ø¨Ø¯ÙˆÙ† ØªØºÛŒÛŒØ± Ø¢Ù…Ø§Ø± Ú©Ù„ÛŒ)</button>
    </div>

    <!-- Ø¨Ø®Ø´ Ø¨Ø§Ø²ÛŒ ÙØ¹Ù„ÛŒ -->
    <div class="current-game" id="currentGameSection">
        <h2>âš”ï¸ Ø¨Ø§Ø²ÛŒ ÙØ¹Ù„ÛŒ</h2>
        <div id="matchupContainer" class="matchup">
            <!-- ØªÛŒÙ…â€ŒÙ‡Ø§ Ø¨Ù‡ ØµÙˆØ±Øª Ø¯Ø§ÛŒÙ†Ø§Ù…ÛŒÚ© Ù¾Ø± Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯ -->
        </div>
    </div>

    <!-- Ù„ÛŒØ³Øª ØªÙ…Ø§Ù… ØªÛŒÙ…â€ŒÙ‡Ø§ Ø¨Ø§ Ú©Ù†ØªØ±Ù„ Ø¯Ø³ØªÛŒ -->
    <div class="teams-list">
        <div class="teams-header">
            <h3>ğŸ“‹ Ù„ÛŒØ³Øª ØªÛŒÙ…â€ŒÙ‡Ø§ (Ø¢Ù…Ø§Ø± Ú©Ù„ÛŒ Ùˆ ÙˆØ¶Ø¹ÛŒØª ÙØ¹Ù„ÛŒ)</h3>
            <span id="teamsCount">Û° ØªÛŒÙ…</span>
        </div>
        <div id="teamsListContainer">
            <!-- ØªÛŒÙ…â€ŒÙ‡Ø§ Ø¨Ù‡ ØµÙˆØ±Øª Ø¯Ø§ÛŒÙ†Ø§Ù…ÛŒÚ© -->
        </div>
    </div>


<!-- Ø¨Ø®Ø´ Ø¢Ù…Ø§Ø± Ú©Ù„ÛŒ (Ù†Ù…Ø§ÛŒØ´ Ù…Ø¬Ù…ÙˆØ¹ Ø¨Ø±Ø¯Ù‡Ø§) -->
    <div class="overall-stats" id="overallStats">
        <h3>ğŸ† Ø¢Ù…Ø§Ø± Ú©Ù„ÛŒ Ø¨Ø±Ø¯Ù‡Ø§</h3>
        <div id="overallStatsContainer" class="stats-summary">
            <!-- Ø¨Ù‡ ØµÙˆØ±Øª Ø¯Ø§ÛŒÙ†Ø§Ù…ÛŒÚ© Ù¾Ø± Ù…ÛŒâ€ŒØ´ÙˆØ¯ -->
        </div>
    </div>

    <footer>Ø¨Ø±Ø§ÛŒ ÙˆÛŒØ±Ø§ÛŒØ´ Ø¯Ø³ØªÛŒ Ø§Ø² Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ + Ùˆ - Ø¯Ø± Ú©Ù†Ø§Ø± Ù‡Ø± Ø¢Ù…Ø§Ø± Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯.</footer>
</div>

<script>
    (function() {
        // ÙˆØ¶Ø¹ÛŒØª Ø§ØµÙ„ÛŒ Ø¨Ø±Ù†Ø§Ù…Ù‡
        let teams = [];                 // Ø¢Ø±Ø§ÛŒÙ‡â€ŒØ§ÛŒ Ø§Ø² Ø§Ø´ÛŒØ§Ø¡ ØªÛŒÙ…: { id, name, wins (Ú©Ù„ÛŒ), pis (ÙØ¹Ù„ÛŒ), singleKots (ÙØ¹Ù„ÛŒ) }
        let teamOrder = [];             // Ø¢Ø±Ø§ÛŒÙ‡â€ŒØ§ÛŒ Ø§Ø² idÙ‡Ø§ Ø¨Ù‡ ØªØ±ØªÛŒØ¨ Ù†ÙˆØ¨Øª

        // Ú©Ù„ÛŒØ¯ localStorage
        const STORAGE_KEY = 'pasourGameData';

        // Ø¹Ù†Ø§ØµØ± DOM
        const teamNameInput = document.getElementById('teamNameInput');
        const addTeamBtn = document.getElementById('addTeamBtn');
        const drawBtn = document.getElementById('drawBtn');
        const endMatchBtn = document.getElementById('endMatchBtn');
        const resetStatsBtn = document.getElementById('resetStatsBtn');
        const matchupContainer = document.getElementById('matchupContainer');
        const teamsListContainer = document.getElementById('teamsListContainer');
        const teamsCountSpan = document.getElementById('teamsCount');
        const overallStatsContainer = document.getElementById('overallStatsContainer');

        // ØªÙˆØ§Ø¨Ø¹ Ú©Ù…Ú©ÛŒ
        function generateId() {
            return Date.now() + '-' + Math.random().toString(36).substr(2, 9);
        }

        // Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø± localStorage
        function saveToLocalStorage() {
            const data = {
                teams: teams,
                teamOrder: teamOrder
            };
            localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
        }

        // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§Ø² localStorage
        function loadFromLocalStorage() {
            const saved = localStorage.getItem(STORAGE_KEY);
            if (saved) {
                try {
                    const data = JSON.parse(saved);
                    teams = data.teams || [];
                    teamOrder = data.teamOrder || [];
                } catch (e) {
                    console.error('Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§', e);
                }
            }
        }

        // Ø±ÛŒØ³Øª Ù¾ÛŒØ³ Ùˆ Ú©ÙˆØª ØªÙ…Ø§Ù… ØªÛŒÙ…â€ŒÙ‡Ø§ (Ø¨Ø¯ÙˆÙ† ØªØºÛŒÛŒØ± wins)
        function resetAllPisAndKots() {
            teams.forEach(t => {
                t.pis = 0;
                t.singleKots = 0;
            });
        }

        // Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù†Ù…Ø§ÛŒØ´ Count ØªÛŒÙ…â€ŒÙ‡Ø§ Ùˆ Ø¢Ù…Ø§Ø± Ú©Ù„ÛŒ
        function updateTeamsCount() {
            teamsCountSpan.textContent = teams.length + ' ØªÛŒÙ…';
        }

        // Ø¹Ù…Ù„ÛŒØ§Øª Ø¨Ø§Ø®Øª ÛŒÚ© ØªÛŒÙ… (ØªÛŒÙ… Ø¨Ø§Ø²Ù†Ø¯Ù‡ Ù…Ø´Ø®Øµ Ù…ÛŒâ€ŒØ´ÙˆØ¯)
        function handleLoss(loserId) {
            // ÙÙ‚Ø· Ø¯Ø± ØµÙˆØ±ØªÛŒ Ú©Ù‡ Ø­Ø¯Ø§Ù‚Ù„ Ø¯Ùˆ ØªÛŒÙ… Ø¯Ø§Ø±ÛŒÙ… Ùˆ Ø¨Ø§Ø²Ù†Ø¯Ù‡ Ø¬Ø²Ùˆ Ø¯Ùˆ ØªÛŒÙ… Ø¨Ø§Ù„Ø§Ø³Øª
            if (teamOrder.length < 2) return;

            const currentFirstId = teamOrder[0];
            const currentSecondId = teamOrder[1];

            if (loserId !== currentFirstId && loserId !== currentSecondId) return;

            const winnerId = (loserId === currentFirstId) ? currentSecondId : currentFirstId;

            const winnerTeam = teams.find(t => t.id === winnerId);
            const loserTeam = teams.find(t => t.id === loserId);

            if (!winnerTeam || !loserTeam) return;

            // Ø§ÙØ²Ø§ÛŒØ´ Ø¨Ø±Ø¯ Ú©Ù„ÛŒ Ø¨Ø±Ù†Ø¯Ù‡
            winnerTeam.wins += 1;

            // Ø±ÛŒØ³Øª Ù¾ÛŒØ³ Ùˆ Ú©ÙˆØª Ù‡Ø± Ø¯Ùˆ ØªÛŒÙ…
            winnerTeam.pis = 0;
            winnerTeam.singleKots = 0;
            loserTeam.pis = 0;
            loserTeam.singleKots = 0;

            // Ø¬Ø§Ø¨Ø¬Ø§ÛŒÛŒ ØªÛŒÙ… Ø¨Ø§Ø²Ù†Ø¯Ù‡ Ø¨Ù‡ Ø§Ù†ØªÙ‡Ø§ÛŒ ØµÙ
            const loserIndex = teamOrder.indexOf(loserId);
            if (loserIndex !== -1) {
                teamOrder.splice(loserIndex, 1);
                teamOrder.push(loserId);
            }

            // Ø°Ø®ÛŒØ±Ù‡ Ùˆ Ø±Ù†Ø¯Ø±
            saveToLocalStorage();
            render();
        }

        // Ø§ÙØ²Ø§ÛŒØ´ Ù¾ÛŒØ³ Ø¨Ø§ Ø¨Ø±Ø±Ø³ÛŒ Ø¨Ø§Ø®Øª
        function handleIncrementPis(teamId) {
            const team = teams.find(t => t.id === teamId);
            if (!team) return;


// ÙÙ‚Ø· ØªÛŒÙ…â€ŒÙ‡Ø§ÛŒ Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø²ÛŒ Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ù†Ø¯ Ù¾ÛŒØ³ Ø¨Ú¯ÛŒØ±Ù†Ø¯ (Ø§Ø®ØªÛŒØ§Ø±ÛŒ)
            if (teamOrder.length < 2 || (teamId !== teamOrder[0] && teamId !== teamOrder[1])) {
                alert('Ø§ÛŒÙ† ØªÛŒÙ… Ø¯Ø± Ø­Ø§Ù„ Ø­Ø§Ø¶Ø± Ø¨Ø§Ø²ÛŒ Ù†Ù…ÛŒâ€ŒÚ©Ù†Ø¯.');
                return;
            }

            team.pis = (team.pis || 0) + 1;
            if (team.pis >= 4) {
                handleLoss(teamId);
            } else {
                saveToLocalStorage();
                render();
            }
        }

        // Ú©Ø§Ù‡Ø´ Ù¾ÛŒØ³ (Ø¯Ø³ØªÛŒ)
        function handleDecrementPis(teamId) {
            const team = teams.find(t => t.id === teamId);
            if (!team) return;
            if (team.pis > 0) {
                team.pis -= 1;
                saveToLocalStorage();
                render();
            }
        }

        // Ø§ÙØ²Ø§ÛŒØ´ Ú©ÙˆØª ØªÚ©ÛŒ
        function handleIncrementSingleKot(teamId) {
            const team = teams.find(t => t.id === teamId);
            if (!team) return;

            if (teamOrder.length < 2 || (teamId !== teamOrder[0] && teamId !== teamOrder[1])) {
                alert('Ø§ÛŒÙ† ØªÛŒÙ… Ø¯Ø± Ø­Ø§Ù„ Ø­Ø§Ø¶Ø± Ø¨Ø§Ø²ÛŒ Ù†Ù…ÛŒâ€ŒÚ©Ù†Ø¯.');
                return;
            }

            team.singleKots = (team.singleKots || 0) + 1;
            if (team.singleKots >= 2) {
                handleLoss(teamId);
            } else {
                saveToLocalStorage();
                render();
            }
        }

        // Ú©Ø§Ù‡Ø´ Ú©ÙˆØª ØªÚ©ÛŒ (Ø¯Ø³ØªÛŒ)
        function handleDecrementSingleKot(teamId) {
            const team = teams.find(t => t.id === teamId);
            if (!team) return;
            if (team.singleKots > 0) {
                team.singleKots -= 1;
                saveToLocalStorage();
                render();
            }
        }

        // Ú©ÙˆØª Ø­Ø§Ú©Ù…ÛŒ (Ø¨Ø§Ø®Øª Ù…Ø³ØªÙ‚ÛŒÙ…)
        function handleHakemiKot(teamId) {
            const team = teams.find(t => t.id === teamId);
            if (!team) return;

            if (teamOrder.length < 2 || (teamId !== teamOrder[0] && teamId !== teamOrder[1])) {
                alert('Ø§ÛŒÙ† ØªÛŒÙ… Ø¯Ø± Ø­Ø§Ù„ Ø­Ø§Ø¶Ø± Ø¨Ø§Ø²ÛŒ Ù†Ù…ÛŒâ€ŒÚ©Ù†Ø¯.');
                return;
            }

            handleLoss(teamId);
        }

        // Ø¨Ø§Ø®Øª Ø¯Ø³ØªÛŒ (Ø¨Ø±Ø§ÛŒ Ù…ÙˆØ§Ù‚Ø¹ Ø¶Ø±ÙˆØ±ÛŒ)
        function handleManualLoss(teamId) {
            const team = teams.find(t => t.id === teamId);
            if (!team) return;

            if (teamOrder.length < 2 || (teamId !== teamOrder[0] && teamId !== teamOrder[1])) {
                alert('Ø§ÛŒÙ† ØªÛŒÙ… Ø¯Ø± Ø­Ø§Ù„ Ø­Ø§Ø¶Ø± Ø¨Ø§Ø²ÛŒ Ù†Ù…ÛŒâ€ŒÚ©Ù†Ø¯.');
                return;
            }

            handleLoss(teamId);
        }

        // Ø§ÙØ²Ø§ÛŒØ´ Ø¨Ø±Ø¯ Ú©Ù„ÛŒ (Ø¯Ø³ØªÛŒ)
        function handleIncrementWin(teamId) {
            const team = teams.find(t => t.id === teamId);
            if (!team) return;
            team.wins += 1;
            saveToLocalStorage();
            render();
        }

        // Ú©Ø§Ù‡Ø´ Ø¨Ø±Ø¯ Ú©Ù„ÛŒ (Ø¯Ø³ØªÛŒ)
        function handleDecrementWin(teamId) {
            const team = teams.find(t => t.id === teamId);
            if (!team) return;
            if (team.wins > 0) {
                team.wins -= 1;
                saveToLocalStorage();
                render();
            }
        }

        // Ø§ÙØ²ÙˆØ¯Ù† ØªÛŒÙ… Ø¬Ø¯ÛŒØ¯
        function addTeam(name) {
            if (!name.trim()) {
                alert('Ù„Ø·ÙØ§Ù‹ Ù†Ø§Ù… ØªÛŒÙ… Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.');
                return;
            }
            if (teams.some(t => t.name === name.trim())) {
                alert('ØªÛŒÙ…ÛŒ Ø¨Ø§ Ø§ÛŒÙ† Ù†Ø§Ù… ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø±Ø¯.');
                return;
            }

            const newTeam = {
                id: generateId(),
                name: name.trim(),
                wins: 0,
                pis: 0,
                singleKots: 0
            };
            teams.push(newTeam);
            teamOrder.push(newTeam.id);  // Ø¨Ù‡ Ø§Ù†ØªÙ‡Ø§ÛŒ ØµÙ Ø§Ø¶Ø§ÙÙ‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯
            teamNameInput.value = '';
            saveToLocalStorage();
            render();
        }

        // Ø­Ø°Ù ØªÛŒÙ…
        function removeTeam(teamId) {
            // Ø§Ú¯Ø± ØªÛŒÙ… Ø¬Ø²Ùˆ Ø¯Ùˆ ØªÛŒÙ… Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø²ÛŒ Ø§Ø³ØªØŒ Ø§Ø¬Ø§Ø²Ù‡ Ø­Ø°Ù Ù†Ø¯Ù‡
            if (teamOrder.


length >= 2 && (teamId === teamOrder[0] || teamId === teamOrder[1])) {
                alert('Ø§Ù…Ú©Ø§Ù† Ø­Ø°Ù ØªÛŒÙ… Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø²ÛŒ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯. Ø§Ø¨ØªØ¯Ø§ ØµØ¨Ø± Ú©Ù†ÛŒØ¯ ØªØ§ Ø¨Ø§Ø²ÛŒ ØªÙ…Ø§Ù… Ø´ÙˆØ¯.');
                return;
            }

            // Ø­Ø°Ù Ø§Ø² teams
            teams = teams.filter(t => t.id !== teamId);
            // Ø­Ø°Ù Ø§Ø² teamOrder
            teamOrder = teamOrder.filter(id => id !== teamId);

            saveToLocalStorage();
            render();
        }

        // Ù‚Ø±Ø¹Ù‡â€ŒÚ©Ø´ÛŒ Ùˆ ØªÙ†Ø¸ÛŒÙ… ØªØ±ØªÛŒØ¨ ØªØµØ§Ø¯ÙÛŒ
        function shuffleAndStart() {
            if (teams.length < 2) {
                alert('Ø­Ø¯Ø§Ù‚Ù„ Ø¨Ù‡ Ø¯Ùˆ ØªÛŒÙ… Ù†ÛŒØ§Ø² Ø¯Ø§Ø±ÛŒØ¯.');
                return;
            }

            // Ø´Ø§ÙÙ„ Ú©Ø±Ø¯Ù† Ø¢Ø±Ø§ÛŒÙ‡ teamOrder
            for (let i = teamOrder.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [teamOrder[i], teamOrder[j]] = [teamOrder[j], teamOrder[i]];
            }

            // Ø±ÛŒØ³Øª Ù¾ÛŒØ³ Ùˆ Ú©ÙˆØª Ù‡Ù…Ù‡ ØªÛŒÙ…â€ŒÙ‡Ø§ Ø¨Ø±Ø§ÛŒ Ø´Ø±ÙˆØ¹ Ø¬Ø¯ÛŒØ¯
            resetAllPisAndKots();

            saveToLocalStorage();
            render();
        }

        // Ø±ÛŒØ³Øª Ú©Ø§Ù…Ù„ Ø¢Ù…Ø§Ø± (Ø¨Ø¯ÙˆÙ† ØªØºÛŒÛŒØ± wins Ú©Ù„ÛŒ) - ÙÙ‚Ø· Ù¾ÛŒØ³ Ùˆ Ú©ÙˆØª ØµÙØ± Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯
        function resetStats() {
            resetAllPisAndKots();
            saveToLocalStorage();
            render();
        }

        // Ù¾Ø§ÛŒØ§Ù† Ù…Ø³Ø§Ø¨Ù‚Ù‡: Ø¨Ù‡ ØªÛŒÙ… Ø§ÙˆÙ„ ÛŒÚ© Ø¨Ø±Ø¯ Ø§Ø¶Ø§ÙÙ‡ Ú©Ù† Ùˆ Ù‡Ù…Ù‡ Ù¾ÛŒØ³â€ŒÙ‡Ø§ Ùˆ Ú©ÙˆØªâ€ŒÙ‡Ø§ Ø±Ø§ Ø±ÛŒØ³Øª Ú©Ù†
        function endMatch() {
            if (teamOrder.length === 0) {
                alert('ØªÛŒÙ…ÛŒ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯.');
                return;
            }
            const firstTeamId = teamOrder[0];
            const firstTeam = teams.find(t => t.id === firstTeamId);
            if (firstTeam) {
                firstTeam.wins += 1;
            }
            resetAllPisAndKots();
            saveToLocalStorage();
            render();
        }

        // ØªØ§Ø¨Ø¹ Ø±Ù†Ø¯Ø± Ø§ØµÙ„ÛŒ
        function render() {
            updateTeamsCount();

            // Ø±Ù†Ø¯Ø± Ø¨Ø®Ø´ Ø¨Ø§Ø²ÛŒ ÙØ¹Ù„ÛŒ
            if (teamOrder.length >= 2) {
                const team1Id = teamOrder[0];
                const team2Id = teamOrder[1];
                const team1 = teams.find(t => t.id === team1Id);
                const team2 = teams.find(t => t.id === team2Id);

                if (team1 && team2) {
                    matchupContainer.innerHTML = `
                        <div class="team-card">
                            <h3>${team1.name}</h3>
                            <div class="stats">
                                <span>ğŸ† Ø¨Ø±Ø¯ ${team1.wins}</span>
                                <span>ğŸ´ Ù¾ÛŒØ³ ${team1.pis}</span>
                                <span>âš¡ Ú©ÙˆØª ${team1.singleKots}</span>
                            </div>
                            <div class="actions">
                                <button class="pis-btn" data-team-id="${team1.id}">ğŸ´ +Ù¾ÛŒØ³</button>
                                <button class="kot-taki-btn" data-team-id="${team1.id}">âš¡ +Ú©ÙˆØª ØªÚ©ÛŒ</button>
                                <button class="kot-hakemi-btn" data-team-id="${team1.id}">ğŸ”¥ Ú©ÙˆØª Ø­Ø§Ú©Ù…ÛŒ</button>
                                <button class="manual-loss-btn" data-team-id="${team1.id}">âŒ Ø¨Ø§Ø®Øª Ù…Ø³ØªÙ‚ÛŒÙ…</button>
                            </div>
                        </div>
                        <div class="team-card">
                            <h3>${team2.name}</h3>
                            <div class="stats">
                                <span>ğŸ† Ø¨Ø±Ø¯ ${team2.wins}</span>
                                <span>ğŸ´ Ù¾ÛŒØ³ ${team2.pis}</span>
                                <span>âš¡ Ú©ÙˆØª ${team2.singleKots}</span>
                            </div>
                            <div class="actions">
                                <button class="pis-btn" data-team-id="${team2.id}">ğŸ´ +Ù¾ÛŒØ³</button>
                                <button class="kot-taki-btn" data-team-id="${team2.id}">âš¡ +Ú©ÙˆØª ØªÚ©ÛŒ</button>
                                <button class="kot-hakemi-btn" data-team-id="${team2.id}">ğŸ”¥ Ú©ÙˆØª Ø­Ø§Ú©Ù…ÛŒ</button>
                                <button class="manual-loss-btn" data-team-id="${team2.id}">âŒ Ø¨Ø§Ø®Øª Ù…Ø³ØªÙ‚ÛŒÙ…</button>


</div>
                        </div>
                    `;
                } else {
                    matchupContainer.innerHTML = '<div class="empty-state">Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ ØªÛŒÙ…â€ŒÙ‡Ø§</div>';
                }
            } else {
                matchupContainer.innerHTML = '<div class="empty-state">Ø¨Ø±Ø§ÛŒ Ø´Ø±ÙˆØ¹ Ø¨Ø§Ø²ÛŒ Ø­Ø¯Ø§Ù‚Ù„ Ø¯Ùˆ ØªÛŒÙ… Ù„Ø§Ø²Ù… Ø§Ø³Øª.</div>';
            }

            // Ø±Ù†Ø¯Ø± Ù„ÛŒØ³Øª ØªÙ…Ø§Ù… ØªÛŒÙ…â€ŒÙ‡Ø§ Ø¨Ø§ Ú©Ù†ØªØ±Ù„â€ŒÙ‡Ø§ÛŒ Ø¯Ø³ØªÛŒ
            if (teams.length === 0) {
                teamsListContainer.innerHTML = '<div class="empty-state">Ù‡ÛŒÚ† ØªÛŒÙ…ÛŒ Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª. ØªÛŒÙ… Ø¬Ø¯ÛŒØ¯ Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†ÛŒØ¯.</div>';
            } else {
                let teamsHtml = '';
                teams.forEach(team => {
                    const isPlaying = teamOrder.length >= 2 && (team.id === teamOrder[0] || team.id === teamOrder[1]);
                    teamsHtml += `
                        <div class="team-row">
                            <div class="team-info">
                                <span class="team-name">${team.name}</span>
                                <div class="stat-control">
                                    <button class="small inc-win" data-team-id="${team.id}">+</button>
                                    <span>ğŸ† ${team.wins}</span>
                                    <button class="small dec-win" data-team-id="${team.id}" ${team.wins === 0 ? 'disabled' : ''}>-</button>
                                </div>
                                <div class="stat-control">
                                    <button class="small inc-pis" data-team-id="${team.id}">+</button>
                                    <span>ğŸ´ ${team.pis}</span>
                                    <button class="small dec-pis" data-team-id="${team.id}" ${team.pis === 0 ? 'disabled' : ''}>-</button>
                                </div>
                                <div class="stat-control">
                                    <button class="small inc-kot" data-team-id="${team.id}">+</button>
                                    <span>âš¡ ${team.singleKots}</span>
                                    <button class="small dec-kot" data-team-id="${team.id}" ${team.singleKots === 0 ? 'disabled' : ''}>-</button>
                                </div>
                            </div>
                            <button class="remove-btn" data-team-id="${team.id}" ${isPlaying ? 'disabled' : ''}>ğŸ—‘ Ø­Ø°Ù</button>
                        </div>
                    `;
                });
                teamsListContainer.innerHTML = teamsHtml;
            }

            // Ø±Ù†Ø¯Ø± Ø¢Ù…Ø§Ø± Ú©Ù„ÛŒ (ÙÙ‚Ø· Ù…Ø¬Ù…ÙˆØ¹ Ø¨Ø±Ø¯Ù‡Ø§)
            if (teams.length > 0) {
                let overallHtml = '';
                teams.forEach(team => {
                    overallHtml += `<span><strong>${team.name}:</strong> ${team.wins}</span>`;
                });
                overallStatsContainer.innerHTML = overallHtml;
            } else {
                overallStatsContainer.innerHTML = '<span>Ø¢Ù…Ø§Ø±ÛŒ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯</span>';
            }

            // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† event listeners Ø¨Ù‡ Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ù¾ÙˆÛŒØ§ (Ø¨Ø§Ø²ÛŒ ÙØ¹Ù„ÛŒ)
            document.querySelectorAll('.pis-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const teamId = btn.dataset.teamId;
                    handleIncrementPis(teamId);
                });
            });

            document.querySelectorAll('.kot-taki-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const teamId = btn.dataset.teamId;
                    handleIncrementSingleKot(teamId);
                });
            });

            document.querySelectorAll('.kot-hakemi-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const teamId = btn.dataset.teamId;
                    handleHakemiKot(teamId);
                });
            });

            document.querySelectorAll('.manual-loss-btn').


forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const teamId = btn.dataset.teamId;
                    handleManualLoss(teamId);
                });
            });

            // event listeners Ø¨Ø±Ø§ÛŒ Ú©Ù†ØªØ±Ù„â€ŒÙ‡Ø§ÛŒ Ø¯Ø³ØªÛŒ Ø¯Ø± Ù„ÛŒØ³Øª
            document.querySelectorAll('.inc-win').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const teamId = btn.dataset.teamId;
                    handleIncrementWin(teamId);
                });
            });
            document.querySelectorAll('.dec-win').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const teamId = btn.dataset.teamId;
                    handleDecrementWin(teamId);
                });
            });
            document.querySelectorAll('.inc-pis').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const teamId = btn.dataset.teamId;
                    // Ø§ÙØ²Ø§ÛŒØ´ Ù¾ÛŒØ³ Ø¯Ø³ØªÛŒ: Ù…Ø´Ø§Ø¨Ù‡ Ø±ÙˆÛŒØ¯Ø§Ø¯ Ø¨Ø§Ø²ÛŒ Ø§Ù…Ø§ Ø¨Ø¯ÙˆÙ† Ù…Ø­Ø¯ÙˆØ¯ÛŒØª Ø¨Ø§Ø²ÛŒØŸ Ø§Ù…Ø§ Ø§Ú¯Ø± ØªÛŒÙ… Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø²ÛŒ Ù†Ø¨Ø§Ø´Ø¯ØŒ Ø§Ø¬Ø§Ø²Ù‡ Ø¨Ø¯Ù‡ÛŒÙ…ØŸ Ø§Ø­ØªÙ…Ø§Ù„Ø§Ù‹ Ø¨Ù„Ù‡ØŒ Ø¨Ø±Ø§ÛŒ ÙˆÛŒØ±Ø§ÛŒØ´ Ø¯Ø³ØªÛŒ Ù‡Ø± Ø²Ù…Ø§Ù† Ù…Ø¬Ø§Ø² Ø§Ø³Øª.
                    const team = teams.find(t => t.id === teamId);
                    if (team) {
                        team.pis += 1;
                        // Ø¨Ø±Ø±Ø³ÛŒ Ø¨Ø§Ø®Øª
                        if (team.pis >= 4) {
                            // Ø§Ú¯Ø± Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø²ÛŒ Ø¨Ø§Ø´Ø¯ØŒ Ø¨Ø§Ø®Øª Ø±Ø® Ø¯Ù‡Ø¯ØŸ Ø¯Ø± ÙˆÛŒØ±Ø§ÛŒØ´ Ø¯Ø³ØªÛŒØŒ Ø§Ú¯Ø± ØªÛŒÙ… Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø²ÛŒ Ù†Ø¨Ø§Ø´Ø¯ØŒ Ù†Ø¨Ø§ÛŒØ¯ Ø¨Ø§Ø®Øª Ø§ØªÙØ§Ù‚ Ø¨ÛŒÙØªØ¯ØŸ Ø§Ù…Ø§ Ù…Ù†Ø·Ù‚Ø§Ù‹ Ø§Ú¯Ø± ØªÛŒÙ…ÛŒ Ù¾ÛŒØ³Ø´ Ø¨Ù‡ Û´ Ø¨Ø±Ø³Ø¯ Ø¨Ø§ÛŒØ¯ Ø¨Ø§Ø²Ù†Ø¯Ù‡ Ø´ÙˆØ¯. Ø¨Ù‡ØªØ± Ø§Ø³Øª Ù‡Ù…Ø§Ù† handleLoss Ø±Ø§ ØµØ¯Ø§ Ø¨Ø²Ù†ÛŒÙ… Ø§Ù…Ø§ ÙÙ‚Ø· Ø§Ú¯Ø± Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø²ÛŒ Ø¨Ø§Ø´Ø¯.
                            if (teamOrder.length >= 2 && (team.id === teamOrder[0] || team.id === teamOrder[1])) {
                                handleLoss(team.id);
                            } else {
                                // Ø§Ú¯Ø± Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø²ÛŒ Ù†ÛŒØ³ØªØŒ ÙÙ‚Ø· Ù¾ÛŒØ³ Ø±Ø§ Ø«Ø¨Øª Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ… Ùˆ Ø¨Ø§Ø®ØªÛŒ Ø±Ø® Ù†Ù…ÛŒâ€ŒØ¯Ù‡Ø¯ (Ú†ÙˆÙ† Ø¨Ø§Ø²ÛŒ Ù†Ù…ÛŒâ€ŒÚ©Ù†Ø¯). Ø§Ù…Ø§ Ø´Ø§ÛŒØ¯ Ø¨Ù‡ØªØ± Ø§Ø³Øª Ø§Ø¬Ø§Ø²Ù‡ Ø¯Ù‡ÛŒÙ… Ù‡Ø± Ù…Ù‚Ø¯Ø§Ø±ÛŒ Ø¨Ø§Ø´Ø¯.
                                saveToLocalStorage();
                                render();
                            }
                        } else {
                            saveToLocalStorage();
                            render();
                        }
                    }
                });
            });
            document.querySelectorAll('.dec-pis').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const teamId = btn.dataset.teamId;
                    const team = teams.find(t => t.id === teamId);
                    if (team && team.pis > 0) {
                        team.pis -= 1;
                        saveToLocalStorage();
                        render();
                    }
                });
            });
            document.querySelectorAll('.inc-kot').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const teamId = btn.dataset.teamId;
                    const team = teams.find(t => t.id === teamId);
                    if (team) {
                        team.singleKots += 1;
                        if (team.singleKots >= 2) {
                            if (teamOrder.length >= 2 && (team.id === teamOrder[0] || team.id === teamOrder[1])) {
                                handleLoss(team.id);
                            } else {
                                saveToLocalStorage();
                                render();
                            }
                        } else {
                            saveToLocalStorage();
                            render();
                        }
                    }
                });
            });
            document.querySelectorAll('.dec-kot').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.


stopPropagation();
                    const teamId = btn.dataset.teamId;
                    const team = teams.find(t => t.id === teamId);
                    if (team && team.singleKots > 0) {
                        team.singleKots -= 1;
                        saveToLocalStorage();
                        render();
                    }
                });
            });

            document.querySelectorAll('.remove-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const teamId = btn.dataset.teamId;
                    removeTeam(teamId);
                });
            });
        }

        // Event listeners Ø¨Ø±Ø§ÛŒ Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ø«Ø§Ø¨Øª
        addTeamBtn.addEventListener('click', () => {
            addTeam(teamNameInput.value);
        });

        teamNameInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                addTeam(teamNameInput.value);
            }
        });

        drawBtn.addEventListener('click', shuffleAndStart);

        endMatchBtn.addEventListener('click', endMatch);

        resetStatsBtn.addEventListener('click', resetStats);

        // Ù…Ù‚Ø¯Ø§Ø±Ø¯Ù‡ÛŒ Ø§ÙˆÙ„ÛŒÙ‡: Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§Ø² localStorage ÛŒØ§ Ø§ÛŒØ¬Ø§Ø¯ Ù†Ù…ÙˆÙ†Ù‡ Ù¾ÛŒØ´â€ŒÙØ±Ø¶
        loadFromLocalStorage();
        if (teams.length === 0) {
            // Ø§ÛŒØ¬Ø§Ø¯ ØªÛŒÙ…â€ŒÙ‡Ø§ÛŒ Ù¾ÛŒØ´â€ŒÙØ±Ø¶
            const defaultNames = ['Ù…ÛŒÙ„Ø§Ø¯','Ø¬ÙˆÙ„ÛŒØ§'];
            defaultNames.forEach(name => {
                const newTeam = {
                    id: generateId(),
                    name: name,
                    wins: 0,
                    pis: 0,
                    singleKots: 0
                };
                teams.push(newTeam);
                teamOrder.push(newTeam.id);
            });
            // Ù‚Ø±Ø¹Ù‡â€ŒÚ©Ø´ÛŒ Ø§ÙˆÙ„ÛŒÙ‡
            shuffleAndStart();
        }
        render();
    })();
</script>
</body>
</html>
